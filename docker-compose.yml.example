version: "3"

services:

  mariadb:
    restart: unless-stopped
    image: mariadb:latest
    ports:
    # Database port will be open only on localhost
    - 127.0.0.1:3308:3306
    volumes:
    # Path to folder of local filesystem with database files
    - ./database/mariadb:/var/lib/mysql
    - ./dump:/docker-entrypoint-initdb.d
    environment:
    # Parameters which will be used in application
    - MYSQL_ROOT_PASSWORD=rootpass
    - MYSQL_ROOT_HOST=%
    - MYSQL_DATABASE=sqlinjection
    - MYSQL_USER=user
    - MYSQL_PASSWORD=userpass

  application:
    image: php-mysql:5.4-apache
    environment:
    # Database parameters of app
    - DB_HOST=mariadb
    - DB_NAME=sqlinjection
    - DB_USER=user
    - DB_PASS=userpass
    # Settings of php.ini
    - PHP_SHORT_OPEN_TAG=On
    - PHP_ERROR_REPORTING=E_ALL
    - PHP_DISPLAY_ERRORS=On
    - PHP_HTML_ERRORS=On
    - PHP_XDEBUG_ENABLED=true
    volumes:
    # Folder in which will be "public" folder with index.php
    # and other sources of application
    - ./html:/app
    ports:
    - 8888:80

